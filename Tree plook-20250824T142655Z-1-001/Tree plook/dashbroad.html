</div>

  <!-- Activity Submission Modal -->
  <div id="activityModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-header">
        <h3 id="activityModalTitle">üì∏ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
        <button class="close" onclick="closeActivityModal()">√ó</button>
      </div>
      
      <div style="margin-bottom:16px">
        <label style="display:block;font-weight:600;margin-bottom:8px;color:var(--green-dark)">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</label>
        <div id="cameraContainer" style="position:relative;width:100%;height:250px;border-radius:12px;background:#000;border:2px solid #d1d5db;overflow:hidden">
          <video id="activityVideo" playsinline autoplay muted style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover"></video>
          <canvas id="activitySnapshot" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;display:none"></canvas>
          <div id="cameraPlaceholder" style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:#f3f4f6;color:#6b7280">
            <div style="text-align:center">
              <div style="font-size:40px;margin-bottom:8px">üì∑</div>
              <div id="cameraStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á...</div>
            </div>
          </div>
        </div>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
          <button id="takePhotoBtn" class="primary-btn" onclick="takeActivityPhoto()" disabled style="width:auto;padding:12px 20px;font-size:14px;opacity:0.5">üì∑ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</button>
          <button id="retakePhotoBtn" class="ghost-btn" onclick="retakeActivityPhoto()" style="display:none;width:auto;padding:12px 20px;font-size:14px">‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</button>
        </div>
      </div>
      
      <div style="margin-bottom:16px">
        <label style="display:block;font-weight:600;margin-bottom:8px;color:var(--green-dark)">‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥:</label>
        <textarea id="activityDescription" placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏¢‡∏Å‡∏Ç‡∏¢‡∏∞‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô ‡πÅ‡∏¢‡∏Å‡πÑ‡∏î‡πâ 5 ‡πÉ‡∏ö ‡∏ô‡∏≥‡πÑ‡∏õ‡∏Ç‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤..."></textarea>
      </div>
      
      <div style="display:flex;gap:12px">
        <button id="submitActivityBtn" class="primary-btn" onclick="submitActivity()" disabled style="opacity:0.5;background:#9ca3af">
          ü§ñ ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ AI ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
        </button>
        <button class="ghost-btn" onclick="closeActivityModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
      
      <p class="hint">üí° AI ‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</p>
    </div>
  </div>

  <!-- Roadmap Modal -->
  <div id="roadmapModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <div class="modal-header">
        <h3>üó∫Ô∏è ‡∏û‡∏∑‡∏ä‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</h3>
        <button class="close" onclick="closeRoadmap()">√ó</button>
      </div>
      <div class="chip-group">
        <button id="chipTime"   class="chip active" onclick="setRoadmapSort('time')">‚è≥ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏•‡∏π‡∏Å/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å</button>
        <button id="chipRarity" class="chip"        onclick="setRoadmapSort('rarity')">‚≠ê ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡∏¢‡∏≤‡∏Å</button>
      </div>
      <div id="roadmapList" class="roadmap-list"></div>
      <p class="hint">üí° "‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏•‡∏π‡∏Å" ‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ (totalNeeded)</p>
    </div>
  </div>

  <script>
    // SVG ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô
    const SimpleSVGs = {
      seed: `<svg viewBox="0 0 200 200" style="width:200px;height:200px">
        <ellipse cx="100" cy="110" rx="22" ry="30" fill="#6b7b3f" stroke="#4a5327" stroke-width="2"/>
        <ellipse cx="98" cy="105" rx="6" ry="10" fill="#8b9556" opacity="0.6"/>
      </svg>`,
      sprout: `<svg viewBox="0 0 200 200" style="width:200px;height:200px">
        <rect x="96" y="100" width="8" height="46" rx="4" fill="#5a7631"/>
        <path d="M100 98 C118 88, 130 78, 134 68 C120 70, 108 78, 100 92 Z" fill="#22c55e"/>
        <path d="M100 108 C84 98, 72 88, 66 78 C80 80, 92 88, 100 102 Z" fill="#22c55e"/>
      </svg>`,
      sapling: `<svg viewBox="0 0 200 200" style="width:200px;height:200px">
        <rect x="106" y="78" width="8" height="80" rx="4" fill="#5a7631"/>
        <ellipse cx="110" cy="88" rx="35" ry="20" fill="#22c55e"/>
        <ellipse cx="110" cy="105" rx="30" ry="18" fill="#16a34a"/>
      </svg>`,
      tree: `<svg viewBox="0 0 200 200" style="width:200px;height:200px">
        <rect x="114" y="90" width="12" height="92" rx="6" fill="#5a7631"/>
        <ellipse cx="120" cy="88" rx="45" ry="35" fill="#22c55e"/>
        <ellipse cx="120" cy="95" rx="38" ry="28" fill="#16a34a"/>
      </svg>`
    };

    // Species chain: mungbean -> basil -> sunflower -> bamboo -> oak -> sakura
    const speciesList = [
      { key:"mungbean", name:"‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (Mung Bean)", stages:[
          {upto:10,svg:"seed",label:"‡πÄ‡∏°‡∏•‡πá‡∏î"}, {upto:35,svg:"sprout",label:"‡πÅ‡∏ï‡∏Å‡∏´‡∏ô‡πà‡∏≠"},
          {upto:65,svg:"sapling",label:"‡∏Å‡∏•‡πâ‡∏≤"}, {upto:100,svg:"tree",label:"‡πÇ‡∏ï‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà"}
        ], totalNeeded:300, rarity:1, next:"basil" },
      { key:"basil", name:"‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤ (Basil)", stages:[
          {upto:15,svg:"seed",label:"‡πÄ‡∏°‡∏•‡πá‡∏î"}, {upto:45,svg:"sprout",label:"‡πÅ‡∏ï‡∏Å‡πÉ‡∏ö"},
          {upto:80,svg:"sapling",label:"‡∏û‡∏∏‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å"}, {upto:100,svg:"tree",label:"‡πÉ‡∏´‡πâ‡πÉ‡∏ö‡∏î‡∏Å"}
        ], totalNeeded:400, rarity:2, next:"sunflower" },
      { key:"sunflower", name:"‡∏ó‡∏≤‡∏ô‡∏ï‡∏∞‡∏ß‡∏±‡∏ô (Sunflower)", stages:[
          {upto:20,svg:"seed",label:"‡πÄ‡∏°‡∏•‡πá‡∏î"}, {upto:55,svg:"sprout",label:"‡∏ï‡∏±‡πâ‡∏á‡∏•‡∏≥‡∏ï‡πâ‡∏ô"},
          {upto:90,svg:"sapling",label:"‡∏ï‡∏π‡∏°‡∏î‡∏≠‡∏Å"}, {upto:100,svg:"tree",label:"‡∏ö‡∏≤‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà"}
        ], totalNeeded:500, rarity:2, next:"bamboo" },
      { key:"bamboo", name:"‡∏ï‡πâ‡∏ô‡πÑ‡∏ú‡πà (Bamboo) ‚Äì ‡∏¢‡∏≤‡∏Å", stages:[
          {upto:20,svg:"seed",label:"‡∏ó‡πà‡∏≠‡∏ô‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå"}, {upto:50,svg:"sprout",label:"‡πÅ‡∏ï‡∏Å‡∏´‡∏ô‡πà‡∏≠"},
          {upto:85,svg:"sapling",label:"‡πÑ‡∏ú‡πà‡∏≠‡πà‡∏≠‡∏ô"}, {upto:100,svg:"tree",label:"‡∏Å‡∏≠‡πÑ‡∏ú‡πà"}
        ], totalNeeded:600, rarity:3, next:"oak" },
      { key:"oak", name:"‡πÇ‡∏≠‡πä‡∏Å (Oak) ‚Äì ‡∏´‡∏≤‡∏¢‡∏≤‡∏Å", stages:[
          {upto:25,svg:"seed",label:"‡πÄ‡∏°‡∏•‡πá‡∏î"}, {upto:60,svg:"sprout",label:"‡∏Å‡∏•‡πâ‡∏≤‡πÑ‡∏°‡πâ"},
          {upto:95,svg:"sapling",label:"‡∏ï‡πâ‡∏ô‡∏≠‡πà‡∏≠‡∏ô"}, {upto:100,svg:"tree",label:"‡∏ó‡∏£‡∏á‡∏û‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà"}
        ], totalNeeded:800, rarity:4, next:"sakura" },
      { key:"sakura", name:"‡∏ã‡∏≤‡∏Å‡∏∏‡∏£‡∏∞ (Sakura) ‚Äì ‡∏ï‡∏≥‡∏ô‡∏≤‡∏ô", stages:[
          {upto:30,svg:"seed",label:"‡πÄ‡∏°‡∏•‡πá‡∏î"}, {upto:70,svg:"sprout",label:"‡πÅ‡∏ï‡∏Å‡πÉ‡∏ö"},
          {upto:95,svg:"sapling",label:"‡∏Å‡∏¥‡πà‡∏á‡∏Å‡πâ‡∏≤‡∏ô"}, {upto:100,svg:"tree",label:"‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å"}
        ], totalNeeded:1000, rarity:5, next:null }
    ];

    // Activity categories
    const activityCategories = {
      waste: { name: '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏∞', icon: '‚ôªÔ∏è', basePoints: 30 },
      transport: { name: '‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á', icon: 'üö≤', basePoints: 20 },
      energy: { name: '‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô', icon: 'üí°', basePoints: 15 },
      nature: { name: '‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥', icon: 'üå±', basePoints: 50 }
    };

    // State
    let coins = 0, speciesIndex = 0, earned = 0;
    let currentActivityCategory = null;
    let activityStream = null;
    let hasPhoto = false;

    // DOM elements - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏û‡∏ö elements
    let elCoins, elVisual, elProgressFill, elProgressText, elSpeciesName, elTreeLevel, elNextSpecies;

    function initializeElements() {
      elCoins = document.getElementById('coins');
      elVisual = document.getElementById('treeVisual');
      elProgressFill = document.getElementById('progressFill');
      elProgressText = document.getElementById('progressText');
      elSpeciesName = document.getElementById('speciesName');
      elTreeLevel = document.getElementById('treeLevel');
      elNextSpecies = document.getElementById('nextSpecies');
      
      console.log('Elements found:', {
        coins: !!elCoins,
        visual: !!elVisual, 
        progressFill: !!elProgressFill,
        progressText: !!elProgressText,
        speciesName: !!elSpeciesName,
        treeLevel: !!elTreeLevel,
        nextSpecies: !!elNextSpecies
      });
      
      if (!elVisual) {
        console.error('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö treeVisual element!');
      } else {
        console.log('‚úÖ ‡∏û‡∏ö treeVisual element ‡πÅ‡∏•‡πâ‡∏ß');
      }
    }

    // Core functions
    function percent(){ return Math.min(100, Math.round(earned / speciesList[speciesIndex].totalNeeded * 100)); }
    function currentStage(p){ return speciesList[speciesIndex].stages.find(s=>p<=s.upto) || speciesList[speciesIndex].stages.at(-1); }
    
    function renderTree(stage){ 
      console.log('üå± ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ:', stage.svg);
      
      const treeDiv = document.getElementById('treeVisual');
      if (!treeDiv) {
        console.error('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö treeVisual element');
        return;
      }
      
      // ‡πÉ‡∏ä‡πâ SVG ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢
      const svg = SimpleSVGs[stage.svg] || SimpleSVGs.seed;
      treeDiv.innerHTML = svg;
      
      console.log('‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à');
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
    function showTestTree() {
      console.log('üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ');
      const treeDiv = document.getElementById('treeVisual');
      if (treeDiv) {
        treeDiv.innerHTML = `<svg viewBox="0 0 200 200" style="width:200px;height:200px;border:2px solid red">
          <circle cx="100" cy="100" r="80" fill="#22c55e" stroke="#16a34a" stroke-width="4"/>
          <text x="100" y="105" text-anchor="middle" fill="white" font-size="16" font-weight="bold">TEST</text>
        </svg>`;
        console.log('‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à');
      } else {
        console.error('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö element ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
      }
    }

    function updateUI(){
      if (elCoins) elCoins.textContent = coins;
      
      const p = percent();
      if (elProgressFill) elProgressFill.style.width = p + '%';

      const stage = currentStage(p);
      renderTree(stage);

      const sp = speciesList[speciesIndex];
      if (elSpeciesName) elSpeciesName.textContent = sp.name;
      if (elTreeLevel) elTreeLevel.textContent = (1 + Math.floor(p/20));
      
      if (elProgressText) {
        elProgressText.textContent = p<100 ? 
          `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: ${p}% | ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å ${100-p}% ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ${stage.label}` : 
          `‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏û‡∏∑‡∏ä‡∏ä‡∏ô‡∏¥‡∏î‡∏ô‡∏µ‡πâ‡πÇ‡∏ï‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß üéâ`;
      }
      
      if (elNextSpecies) {
        elNextSpecies.textContent = sp.next ? 
          (speciesList.find(s=>s.key===sp.next)?.name + " (‡∏¢‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)") : 
          "‚Äì (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß)";
      }
      
      console.log('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó UI ‡πÄ‡∏™‡∏£‡πá‡∏à - ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:', coins, '‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå:', p, '%');
    }

    function addProgress(points){
      coins += points;
      const sp = speciesList[speciesIndex];
      earned = Math.min(sp.totalNeeded, earned + points);
      if (earned >= sp.totalNeeded && sp.next) { 
        setTimeout(() => {
          const nextSpecies = speciesList.find(s=>s.key===sp.next);
          alert(`üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏û‡∏∑‡∏ä‡πÉ‡∏´‡∏°‡πà: ${nextSpecies?.name}`);
        }, 500);
        speciesIndex = speciesList.findIndex(x => x.key === sp.next); 
        earned = 0; 
      }
      updateUI();
    }

    // Plant Care System
    function careForPlant(careType) {
      const carePoints = { water: 5, fertilizer: 10, sunlight: 8 };
      const careNames = { water: '‡∏£‡∏î‡∏ô‡πâ‡∏≥', fertilizer: '‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢', sunlight: '‡πÄ‡∏î‡∏¥‡∏ô‡πÅ‡∏™‡∏á' };
      
      addProgress(carePoints[careType]);
      
      // Visual feedback
      const btn = document.querySelector(`[data-care="${careType}"]`);
      if (btn && !btn.classList.contains('used')) {
        btn.classList.add('used');
        btn.innerHTML = `<div class="care-icon">‚úì</div><div>${careNames[careType]}</div><div class="care-effect">‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß</div>`;
        
        setTimeout(() => {
          alert(`üíö ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£${careNames[careType]} +${carePoints[careType]} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\n\nüå± ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å!`);
        }, 100);
      }
    }

    // Activity Modal Functions
    function openActivityModal(category) {
      console.log('‡πÄ‡∏õ‡∏¥‡∏î modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:', category);
      currentActivityCategory = category;
      const categoryData = activityCategories[category];
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï UI
      document.getElementById('activityModalTitle').textContent = `üì∏ ${categoryData.icon} ${categoryData.name}`;
      document.getElementById('activityModal').classList.add('open');
      document.getElementById('activityModal').setAttribute('aria-hidden', 'false');
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
      hasPhoto = false;
      const textarea = document.getElementById('activityDescription');
      if (textarea) textarea.value = '';
      
      const submitBtn = document.getElementById('submitActivityBtn');
      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.5';
      }
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡πâ‡∏≠‡∏á
      const takeBtn = document.getElementById('takePhotoBtn');
      const retakeBtn = document.getElementById('retakePhotoBtn');
      const videoEl = document.getElementById('activityVideo');
      const canvasEl = document.getElementById('activitySnapshot');
      const placeholderEl = document.getElementById('cameraPlaceholder');
      const statusEl = document.getElementById('cameraStatus');
      
      // ‡πÅ‡∏™‡∏î‡∏á placeholder
      if (placeholderEl) {
        placeholderEl.style.display = 'flex';
        const content = placeholderEl.querySelector('div');
        if (content) {
          content.innerHTML = `
            <div style="font-size:40px;margin-bottom:8px">üì∑</div>
            <div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á...</div>
          `;
        }
      }
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï elements
      if (videoEl) {
        videoEl.style.display = 'block';
        if (videoEl.srcObject) {
          videoEl.srcObject.getTracks().forEach(track => track.stop());
          videoEl.srcObject = null;
        }
      }
      if (canvasEl) canvasEl.style.display = 'none';
      if (statusEl) statusEl.textContent = '‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ï‡∏±‡∏ß...';
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏õ‡∏∏‡πà‡∏°
      if (takeBtn) {
        takeBtn.style.display = 'inline-block';
        takeBtn.disabled = true;
        takeBtn.style.opacity = '0.5';
        takeBtn.style.background = '#9ca3af';
      }
      if (retakeBtn) retakeBtn.style.display = 'none';
      
      // ‡∏´‡∏¢‡∏∏‡∏î stream ‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
      if (activityStream) {
        activityStream.getTracks().forEach(track => track.stop());
        activityStream = null;
      }
      
      // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
      setTimeout(() => {
        startActivityCamera();
      }, 1000);
    }

    function closeActivityModal() {
      console.log('‡∏õ‡∏¥‡∏î modal');
      const modal = document.getElementById('activityModal');
      if (modal) {
        modal.classList.remove('open');
        modal.setAttribute('aria-hidden', 'true');
      }
      
      // ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
      if (activityStream) {
        activityStream.getTracks().forEach(track => {
          console.log('‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á');
          track.stop();
        });
        activityStream = null;
      }
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      hasPhoto = false;
      currentActivityCategory = null;
    }

    async function startActivityCamera() {
      const statusEl = document.getElementById('cameraStatus');
      const placeholderEl = document.getElementById('cameraPlaceholder');
      const videoEl = document.getElementById('activityVideo');
      
      console.log('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á...');
      
      if (statusEl) statusEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á...';
      
      try {
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const devices = await navigator.mediaDevices.enumerateDevices();
        const videoDevices = devices.filter(device => device.kind === 'videoinput');
        
        if (videoDevices.length === 0) {
          throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå');
        }
        
        console.log('‡∏û‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á:', videoDevices.length, '‡∏ï‡∏±‡∏ß');
        
        // ‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
        const constraints = {
          video: {
            facingMode: "environment",
            width: { ideal: 1280, min: 320 },
            height: { ideal: 720, min: 240 }
          },
          audio: false
        };
        
        if (statusEl) statusEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏•‡πâ‡∏≠‡∏á...';
        
        activityStream = await navigator.mediaDevices.getUserMedia(constraints);
        
        if (!activityStream || !videoEl) {
          throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ');
        }
        
        console.log('‡πÑ‡∏î‡πâ stream ‡πÅ‡∏•‡πâ‡∏ß:', activityStream);
        
        // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ stream ‡∏Å‡∏±‡∏ö video element
        videoEl.srcObject = activityStream;
        
        // ‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πà‡∏ô
        const waitForVideo = new Promise((resolve, reject) => {
          const timeout = setTimeout(() => {
            reject(new Error('‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î'));
          }, 10000);
          
          videoEl.onloadedmetadata = () => {
            console.log('‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à - ‡∏Ç‡∏ô‡∏≤‡∏î:', videoEl.videoWidth, 'x', videoEl.videoHeight);
            clearTimeout(timeout);
            resolve();
          };
          
          videoEl.oncanplay = () => {
            console.log('‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô');
            videoEl.play().then(() => {
              console.log('‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            }).catch(playError => {
              console.error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏î‡πâ:', playError);
            });
          };
          
          videoEl.onerror = (e) => {
            clearTimeout(timeout);
            reject(new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•ÿß‡∏î‡∏Å‡∏±‡∏ö‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠: ' + e.message));
          };
        });
        
        await waitForVideo;
        
        // ‡∏ã‡πà‡∏≠‡∏ô placeholder ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
        if (placeholderEl) placeholderEl.style.display = 'none';
        if (statusEl) statusEl.textContent = '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
        
        // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
        const takeBtn = document.getElementById('takePhotoBtn');
        if (takeBtn) {
          takeBtn.disabled = false;
          takeBtn.style.opacity = '1';
          takeBtn.style.background = 'var(--gradient-green)';
        }
        
        console.log('‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
        
      } catch (error) {
        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
        
        let errorMessage = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ';
        let suggestion = '';
        
        if (error.name === 'NotAllowedError') {
          errorMessage = '‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á';
          suggestion = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå';
        } else if (error.name === 'NotFoundError') {
          errorMessage = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå';
          suggestion = '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏•‡πâ‡∏≠‡∏á';
        } else if (error.name === 'NotReadableError') {
          errorMessage = '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÅ‡∏≠‡∏õ‡∏≠‡∏∑‡πà‡∏ô';
          suggestion = '‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
        } else if (error.name === 'OverconstrainedError') {
          errorMessage = '‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£';
          suggestion = '‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô';
        }
        
        if (statusEl) statusEl.textContent = errorMessage;
        if (placeholderEl) {
          const content = placeholderEl.querySelector('div');
          if (content) {
            content.innerHTML = `
              <div style="font-size:32px;margin-bottom:8px">‚ùå</div>
              <div style="font-weight:600;margin-bottom:4px">${errorMessage}</div>
              <div style="font-size:12px">${suggestion}</div>
            `;
          }
        }
        
        alert(`${errorMessage}\n\n${suggestion}\n\n‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:\n- ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö\n- ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏∑‡πà‡∏ô\n- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï`);
      }
    }

    function takeActivityPhoto() {
      const video = document.getElementById('activityVideo');
      const canvas = document.getElementById('activitySnapshot');
      const status = document.getElementById('cameraStatus');
      
      if (!activityStream || !video || !video.videoWidth) {
        alert('‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà');
        return;
      }
      
      console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ - ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:', video.videoWidth, 'x', video.videoHeight);
      
      try {
        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ canvas ‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢ ‡∏ã‡πà‡∏≠‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
        video.style.display = 'none';
        canvas.style.display = 'block';
        
        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°
        document.getElementById('takePhotoBtn').style.display = 'none';
        document.getElementById('retakePhotoBtn').style.display = 'inline-block';
        
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        hasPhoto = true;
        if (status) status.textContent = '‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ - ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á
        checkSubmitReady();
        console.log('‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - hasPhoto:', hasPhoto);
        
      } catch (e) {
        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ:', e);
        alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
      }
    }

    function retakeActivityPhoto() {
      const video = document.getElementById('activityVideo');
      const canvas = document.getElementById('activitySnapshot');
      const status = document.getElementById('cameraStatus');
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ‡∏ã‡πà‡∏≠‡∏ô‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢
      if (video) video.style.display = 'block';
      if (canvas) canvas.style.display = 'none';
      
      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏∏‡πà‡∏°
      document.getElementById('takePhotoBtn').style.display = 'inline-block';
      document.getElementById('retakePhotoBtn').style.display = 'none';
      
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
      hasPhoto = false;
      if (status) status.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà';
      
      checkSubmitReady();
      console.log('‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà');
    }

    function checkSubmitReady() {
      const textarea = document.getElementById('activityDescription');
      const submitBtn = document.getElementById('submitActivityBtn');
      
      if (!textarea || !submitBtn) {
        console.log('‡πÑ‡∏°‡πà‡∏û‡∏ö elements ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô');
        return;
      }
      
      const description = textarea.value.trim();
      console.log('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏° - ‡∏°‡∏µ‡∏£‡∏π‡∏õ:', hasPhoto, '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:', description.length);
      
      if (hasPhoto && description.length > 5) {
        submitBtn.disabled = false;
        submitBtn.style.opacity = '1';
        submitBtn.style.background = 'var(--gradient-green)';
        submitBtn.style.cursor = 'pointer';
        console.log('‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
      } else {
        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.5';
        submitBtn.style.background = '#9ca3af';
        submitBtn.style.cursor = 'not-allowed';
        console.log('‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° - ‡∏£‡∏π‡∏õ:', hasPhoto, '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:', description.length, '‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
      }
    }

    function submitActivity() {
      console.log('‡∏Å‡∏î‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...');
      
      const textarea = document.getElementById('activityDescription');
      const submitBtn = document.getElementById('submitActivityBtn');
      
      if (!textarea || !submitBtn) {
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö elements');
        return;
      }
      
      const description = textarea.value.trim();
      
      if (!hasPhoto) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô');
        return;
      }
      
      if (description.length <= 5) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
        return;
      }
      
      if (!currentActivityCategory) {
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°');
        return;
      }
      
      console.log('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô');
      
      // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
      submitBtn.disabled = true;
      submitBtn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...';
      submitBtn.style.opacity = '0.7';
      
      try {
        const categoryData = activityCategories[currentActivityCategory];
        
        // Simulate AI evaluation
        const aiScore = evaluateActivity(description, currentActivityCategory);
        const finalPoints = Math.round(categoryData.basePoints * aiScore.multiplier);
        
        console.log('AI ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:', aiScore.score, '/', 10, '- ‡πÑ‡∏î‡πâ', finalPoints, '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô');
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ
        addProgress(finalPoints);
        
        // ‡∏õ‡∏¥‡∏î modal
        closeActivityModal();
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        setTimeout(() => {
          const resultMessage = `ü§ñ AI ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß!\n\n` +
            `üìä ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô: ${aiScore.score}/10\n` +
            `üí¨ ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô: "${aiScore.feedback}"\n\n` +
            `üéâ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${finalPoints} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô!\n\n` +
            `${aiScore.tip}`;
          
          alert(resultMessage);
        }, 500);
        
      } catch (error) {
        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô:', error);
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
        
        // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°
        submitBtn.disabled = false;
        submitBtn.textContent = 'ü§ñ ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ AI ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';
        submitBtn.style.opacity = '1';
      }
    }

    // Simple AI evaluation simulation
    function evaluateActivity(description, category) {
      const wordCount = description.split(' ').length;
      const keywordBonus = getKeywordBonus(description, category);
      
      let score = Math.min(10, 5 + Math.floor(wordCount / 5) + keywordBonus);
      let multiplier = 0.5 + (score / 20);
      
      const feedbacks = {
        8: "‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏°‡∏≤‡∏Å",
        7: "‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°", 
        6: "‡∏î‡∏µ! ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏ï‡πà‡∏≠‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°",
        5: "‡∏û‡∏≠‡πÉ‡∏ä‡πâ ‡∏Ñ‡∏ß‡∏£‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",
        4: "‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á ‡∏•‡∏≠‡∏á‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ"
      };
      
      const tips = {
        waste: "üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏•‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏¢‡∏∞‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏î‡πâ‡∏ß‡∏¢",
        transport: "üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏î‡πâ", 
        energy: "üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°",
        nature: "üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á"
      };
      
      return {
        score,
        multiplier,
        feedback: feedbacks[Math.min(8, Math.max(4, score))] || feedbacks[5],
        tip: tips[category] || "üí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö: ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°"
      };
    }

    function getKeywordBonus(description, category) {
      const keywords = {
        waste: ['‡πÅ‡∏¢‡∏Å', '‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•', '‡∏Ç‡∏¢‡∏∞', '‡∏•‡∏î', '‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥', '‡∏ñ‡∏∏‡∏á‡∏ú‡πâ‡∏≤'],
        transport: ['‡πÄ‡∏î‡∏¥‡∏ô', '‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô', '‡∏£‡∏ñ‡πÄ‡∏°‡∏•‡πå', '‡∏£‡∏ñ‡πÑ‡∏ü', '‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î', '‡∏Ñ‡∏≤‡∏£‡πå‡∏ö‡∏≠‡∏ô'],
        energy: ['‡∏õ‡∏¥‡∏î‡πÑ‡∏ü', '‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î', '‡∏ô‡πâ‡∏≥', '‡πÑ‡∏ü‡∏ü‡πâ‡∏≤', '‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô', '‡∏≠‡∏ô‡∏∏‡∏£‡∏±‡∏Å‡∏©‡πå'],
        nature: ['‡∏õ‡∏•‡∏π‡∏Å', '‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ', '‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥', '‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°', '‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', '‡∏≠‡∏ô‡∏∏‡∏£‡∏±‡∏Å‡∏©‡πå']
      };
      
      const categoryKeywords = keywords[category] || [];
      const lowerDesc = description.toLowerCase();
      
      return categoryKeywords.filter(keyword => 
        lowerDesc.includes(keyword)
      ).length;
    }

    // Demo functions
    function resetProgress(){ 
      if(confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà?')) {
        coins=0; speciesIndex=0; earned=0; updateUI(); 
      }
    }

    function jumpToSpecies(targetSpecies) {
      const targetIndex = speciesList.findIndex(s => s.key === targetSpecies);
      if(targetIndex !== -1) {
        speciesIndex = targetIndex;
        earned = 0;
        updateUI();
        setTimeout(() => {
          alert(`üå± ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏¢‡∏±‡∏á: ${speciesList[targetIndex].name}`);
        }, 100);
      }
    }

    // Roadmap functions
    const roadmapModal=document.getElementById('roadmapModal'); 
    const roadmapList=document.getElementById('roadmapList');
    const chipTime=document.getElementById('chipTime'); 
    const chipRarity=document.getElementById('chipRarity'); 
    let roadmapSort='time';

    function openRoadmap(){ 
      roadmapModal.classList.add('open'); 
      roadmapModal.setAttribute('aria-hidden','false'); 
      renderRoadmap(); 
    }

    function closeRoadmap(){ 
      roadmapModal.classList.remove('open'); 
      roadmapModal.setAttribute('aria-hidden','true'); 
    }

    function getNextChain(){ 
      const arr=[]; 
      let key=speciesList[speciesIndex].next; 
      while(key){ 
        const sp=speciesList.find(s=>s.key===key); 
        if(!sp) break; 
        arr.push(sp); 
        key=sp.next; 
      } 
      return arr; 
    }

    function stars(n){ 
      return '‚òÖ'.repeat(Math.min(5,n)) + '‚òÜ'.repeat(Math.max(0,5-n)); 
    }

    function renderRoadmap(){
      const items=getNextChain();
      if(!items.length){ 
        roadmapList.innerHTML='<div class="hint">üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏û‡∏∑‡∏ä‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß</div>'; 
        return; 
      }
      
      const sorted=[...items].sort((a,b)=> 
        roadmapSort==='time' ? a.totalNeeded-b.totalNeeded : (b.rarity||1)-(a.rarity||1)
      );
      
      roadmapList.innerHTML = sorted.map((sp,idx)=>`
        <div class="roadmap-card">
          <div class="rm-left">
            <div class="rm-rank">${idx+1}</div>
            <div>
              <div class="rm-name">${sp.name}</div>
              <div class="rm-meta">‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° ‚âà <b>${sp.totalNeeded.toLocaleString()}</b> | <span class="rm-stars">${stars(sp.rarity||1)}</span></div>
            </div>
          </div>
          <div style="font-size:12px;color:#166534;background:linear-gradient(135deg,#ecfdf5,#f0fdf4);border:1px solid #bbf7d0;padding:8px 12px;border-radius:20px;font-weight:600">üîí ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å</div>
        </div>`).join('');
    }

    function setRoadmapSort(mode){ 
      roadmapSort=mode; 
      chipTime.classList.toggle('active',mode==='time'); 
      chipRarity.classList.toggle('active',mode==='rarity'); 
      renderRoadmap(); 
    }

    // Initialize ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ
    function initializeApp() {
      console.log('üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Green AR App');
      
      // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      setTimeout(() => {
        showTestTree();
      }, 100);
      
      // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô
      setTimeout(() => {
        console.log('üå± ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏à‡∏£‡∏¥‡∏á');
        renderTree({svg: 'seed'});
        updateUI();
      }, 500);
      
      // ‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à
      setTimeout(() => {
        console.log('üîÑ ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
        const stage = currentStage(percent());
        renderTree(stage);
      }, 1000);
    }

    // Event Listeners ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö textarea
    function initEventListeners() {
      console.log('‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ event listeners...');
      
      // ‡πÉ‡∏ä‡πâ event delegation ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡∏Å element ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
      document.addEventListener('input', function(e) {
        if (e.target && e.target.id === 'activityDescription') {
          console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢...');
          checkSubmitReady();
        }
      });
      
      // ‡πÄ‡∏û‡∏¥‡πà‡∏° listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö submit button
      document.addEventListener('click', function(e) {
        if (e.target && e.target.id === 'submitActivityBtn') {
          console.log('‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô');
          if (!e.target.disabled) {
            submitActivity();
          } else {
            console.log('‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
          }
        }
      });
      
      console.log('Event listeners ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à');
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    initializeElements();
    initializeApp();

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ event listeners
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initEventListeners);
    } else {
      initEventListeners();
    }
  </script>
</body>
</html>
        <!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Green AR ‚Äì Grow by Green Actions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root{ 
      --green:#38a169; --green-dark:#2f855a; --green-light:#48cc76; 
      --bg1:#f0fff4; --bg2:#c6f6d5; --card:#fff; --text:#2d3748; --muted:#6b7280; 
      --shadow-light:rgba(56,161,105,.08); --shadow-med:rgba(56,161,105,.15); --shadow-heavy:rgba(56,161,105,.25);
      --gradient-green:linear-gradient(135deg, #38a169 0%, #48cc76 100%);
      --gradient-bg:linear-gradient(135deg, #f0fff4 0%, #e6fffa 25%, #c6f6d5 100%);
    }
    
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    
    body{ 
      font-family:'Sarabun',sans-serif;color:var(--text); 
      background:var(--gradient-bg);
      background-attachment:fixed;
      display:flex;justify-content:center;align-items:stretch;min-height:100dvh; 
      position:relative;
      overflow-x:hidden;
    }

    .app{
      width:clamp(320px,92vw,540px);
      display:flex;flex-direction:column;min-height:100dvh;
      position:relative;
      z-index:1;
    }

    header{ 
      position:sticky;top:0;z-index:10;
      background:rgba(255,255,255,.95);
      backdrop-filter:blur(20px);
      padding:16px 20px;
      border-bottom:1px solid rgba(229,231,235,.5);
      border-radius:20px 20px 0 0; 
      display:flex;justify-content:space-between;align-items:center;
      box-shadow:0 8px 32px rgba(0,0,0,.06);
    }

    .app-title {
      font-size:20px;
      font-weight:800;
      background:var(--gradient-green);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      display:flex;
      align-items:center;
      gap:8px;
    }

    .points{
      background:var(--gradient-green);
      color:#fff;
      padding:10px 16px;
      border-radius:25px;
      font-weight:700;
      font-size:14px;
      box-shadow:0 4px 16px var(--shadow-med);
      position:relative;
      overflow:hidden;
    }

    main{
      flex:1;
      background:rgba(255,255,255,.9);
      backdrop-filter:blur(20px);
      padding:24px;
      border-radius:0 0 20px 20px;
      box-shadow:0 12px 40px rgba(0,0,0,.08);
      padding-bottom:120px;
      position:relative;
    }

    /* Enhanced tree spotlight */
    .tree-container{text-align:center;margin:12px 0 20px}
    
    .tree-spot{ 
      --size:280px;
      width:var(--size);height:var(--size);
      margin:12px auto 0;
      border-radius:50%;
      position:relative;
      display:grid;place-items:center;
      overflow:hidden;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.8) 0%, transparent 50%),
        radial-gradient(circle at 50% 45%, #d9fbe0 0%, #bdf6c6 60%, #a6efb9 80%, transparent 85%);
      box-shadow:
        0 0 0 8px rgba(56,161,105,.06),
        0 0 0 16px rgba(56,161,105,.03),
        0 20px 60px rgba(56,161,105,.35),
        inset 0 20px 40px rgba(255,255,255,.6);
      animation:glow 6s ease-in-out infinite;
    }
    
    .tree-spot::after{ 
      content:""; position:absolute; left:50%; bottom:8%; transform:translateX(-50%);
      width:65%; height:20%; 
      background:radial-gradient(ellipse at center, rgba(0,0,0,.15), rgba(0,0,0,0) 70%);
      filter:blur(12px); opacity:.4; border-radius:50%;
    }
    
    @keyframes glow{
      0%,100%{
        box-shadow:
          0 0 0 8px rgba(56,161,105,.06),
          0 0 0 16px rgba(56,161,105,.03),
          0 20px 60px rgba(56,161,105,.35),
          inset 0 20px 40px rgba(255,255,255,.6);
      }
      50%{
        box-shadow:
          0 0 0 8px rgba(56,161,105,.12),
          0 0 0 16px rgba(56,161,105,.06),
          0 30px 80px rgba(56,161,105,.5),
          inset 0 25px 50px rgba(255,255,255,.8);
      }
    }
    
    .tree-visual{
      width:200px;height:200px;
      display:grid;place-items:center;
      filter:drop-shadow(0 12px 24px rgba(0,0,0,.2));
      animation:sway 4s ease-in-out infinite, pop 3s ease-in-out infinite alternate;
      position:relative;
    }
    
    .tree-visual svg{width:200px;height:200px;display:block}
    
    @keyframes sway{
      0%,100%{transform:rotate(-3deg) scale(1)}
      50%{transform:rotate(3deg) scale(1.02)}
    }
    
    @keyframes pop{
      from{transform:scale(1)}
      to{transform:scale(1.08)}
    }

    /* Enhanced info card */
    .tree-info{
      margin-top:20px;
      background:linear-gradient(135deg, rgba(247,253,248,.95) 0%, rgba(236,253,245,.9) 100%);
      backdrop-filter:blur(10px);
      border-radius:20px;
      padding:20px 18px;
      border:1px solid rgba(209,250,229,.6);
      box-shadow:0 8px 32px rgba(0,0,0,.04);
      position:relative;
      overflow:hidden;
    }

    .tree-info::before {
      content:"";
      position:absolute;
      top:0;left:0;right:0;
      height:2px;
      background:var(--gradient-green);
    }
    
    .info-head{
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      margin-bottom:4px;
    }
    
    .tree-name{
      color:var(--green-dark);
      font-weight:800;
      font-size:18px;
    }
    
    .lvl-badge{
      background:linear-gradient(135deg, #e8ffe7 0%, #dcfce7 100%);
      border:1px solid #bbf7d0;
      color:#166534;
      font-weight:700;
      border-radius:20px;
      padding:8px 14px;
      font-size:12px;
      box-shadow:0 2px 8px rgba(22,101,52,.1);
    }
    
    .progress-bar{
      height:16px;
      border-radius:12px;
      background:#e5e7eb;
      margin:16px 0;
      overflow:hidden;
      box-shadow:inset 0 2px 6px rgba(0,0,0,.1);
      position:relative;
    }
    
    .progress-fill{
      height:100%;width:0;
      background:linear-gradient(135deg, #22c55e 0%, #16a34a 50%, #84cc16 100%);
      transition:width .6s cubic-bezier(0.4, 0, 0.2, 1);
      position:relative;
      border-radius:12px;
    }
    
    .stat-row{
      display:flex;justify-content:space-between;gap:16px;align-items:center;
      margin-top:12px;
    }
    
    .progress-text{font-size:14px;color:var(--muted);font-weight:500}
    .next-label{font-size:14px;color:#0f5132;font-weight:600}
    
    .info-actions{
      display:flex;justify-content:flex-end;
      margin-top:16px;
    }
    
    .btn-pill{
      background:linear-gradient(135deg, #fff 0%, #f8fafc 100%);
      border:1px solid #bbf7d0;
      color:#166534;
      border-radius:25px;
      padding:10px 16px;
      font-size:13px;
      font-weight:600;
      cursor:pointer;
      transition:all .3s ease;
      box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    
    .btn-pill:hover{
      background:linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
      transform:translateY(-2px);
      box-shadow:0 4px 16px rgba(22,101,52,.15);
    }

    /* Category Cards */
    .category-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .category-card {
      background: linear-gradient(135deg, #fff 0%, #fafafa 100%);
      border: 2px solid transparent;
      border-radius: 16px;
      padding: 16px;
      text-align: center;
      cursor: pointer;
      transition: all .3s ease;
      box-shadow: 0 4px 12px rgba(0,0,0,.05);
    }

    .category-card:hover {
      transform: translateY(-4px);
      border-color: var(--green);
      background: linear-gradient(135deg, #f0fff4 0%, #ecfdf5 100%);
      box-shadow: 0 8px 25px rgba(56,161,105,.15);
    }

    .category-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .category-title {
      font-weight: 700;
      font-size: 14px;
      color: var(--green-dark);
      margin-bottom: 4px;
    }

    .category-desc {
      font-size: 11px;
      color: var(--muted);
      line-height: 1.3;
    }

    /* Plant Care Grid */
    .plant-care-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .care-btn {
      background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
      border: 1px solid #d1fae5;
      border-radius: 12px;
      padding: 12px 8px;
      cursor: pointer;
      transition: all .3s ease;
      text-align: center;
      font-size: 12px;
      color: var(--text);
    }

    .care-btn:hover {
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border-color: var(--green);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16,185,129,.15);
    }

    .care-btn.used {
      background: #f3f4f6;
      border-color: #d1d5db;
      color: #9ca3af;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .care-icon {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .care-effect {
      font-size: 10px;
      color: var(--green-dark);
      font-weight: 600;
      margin-top: 2px;
    }

    .primary-btn, .ghost-btn{
      width:100%;
      padding:16px;
      border:none;
      border-radius:16px;
      font-size:16px;
      font-weight:600;
      cursor:pointer;
      transition:all .3s ease;
      position:relative;
      overflow:hidden;
    }
    
    .primary-btn{
      background:var(--gradient-green);
      color:#fff;
      box-shadow:0 4px 20px var(--shadow-med);
    }
    
    .primary-btn:hover{
      background:linear-gradient(135deg, #2f855a 0%, #38a169 100%);
      transform:translateY(-2px);
      box-shadow:0 8px 32px var(--shadow-heavy);
    }
    
    .ghost-btn{
      background:linear-gradient(135deg, #fff 0%, #f8fafc 100%);
      border:1px solid #d1d5db;
      color:var(--text);
      box-shadow:0 2px 8px rgba(0,0,0,.04);
    }

    .ghost-btn:hover{
      background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      transform:translateY(-2px);
      box-shadow:0 4px 16px rgba(0,0,0,.08);
    }

    /* Enhanced bottom navigation */
    .bottom{
      position:fixed;left:0;right:0;bottom:0;
      display:flex;justify-content:center;
      padding:12px;
      z-index:20;
    }
    
    .bottom > div{
      width:clamp(320px,92vw,540px);
      background:rgba(255,255,255,.95);
      backdrop-filter:blur(20px);
      border:1px solid rgba(229,231,235,.5);
      border-radius:20px;
      display:flex;justify-content:space-around;align-items:center;
      padding:8px;
      box-shadow:0 8px 32px rgba(0,0,0,.15);
    }
    
    .navbtn{
      background:none;border:none;
      display:flex;flex-direction:column;align-items:center;
      gap:4px;cursor:pointer;
      color:#6b7280;
      padding:12px 8px;
      border-radius:16px;
      transition:all .3s ease;
      position:relative;
    }

    .navbtn:hover {
      background:rgba(56,161,105,.05);
      transform:translateY(-2px);
    }
    
    .navbtn small{font-size:10px;font-weight:500}
    
    .navbtn.active{
      color:var(--green-dark);
      font-weight:700;
      background:linear-gradient(135deg, rgba(56,161,105,.1) 0%, rgba(72,204,118,.08) 100%);
    }

    /* Enhanced modals */
    .modal{
      position:fixed;inset:0;
      background:rgba(0,0,0,.6);
      backdrop-filter:blur(8px);
      display:none;align-items:center;justify-content:center;
      padding:20px;
      z-index:50;
    }
    
    .modal.open{display:flex;animation:fadeIn .3s ease}

    @keyframes fadeIn {
      from { opacity:0; }
      to { opacity:1; }
    }
    
    .modal-card{
      background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
      border-radius:24px;
      max-width:560px;width:100%;
      padding:24px;
      box-shadow:0 20px 60px rgba(0,0,0,.3);
      transform:translateY(20px);
      animation:slideUp .3s ease forwards;
      position:relative;
    }

    @keyframes slideUp {
      to { transform:translateY(0); }
    }
    
    .modal-header{
      display:flex;justify-content:space-between;align-items:center;
      margin-bottom:16px;
      padding-bottom:12px;
      border-bottom:1px solid #e5e7eb;
    }

    .modal-header h3 {
      font-size:20px;
      font-weight:700;
      color:var(--green-dark);
    }
    
    .close{
      border:none;
      background:rgba(107,114,128,.1);
      font-size:20px;
      cursor:pointer;
      width:36px;height:36px;
      border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      transition:all .2s ease;
    }

    .close:hover {
      background:rgba(239,68,68,.1);
      color:#dc2626;
    }
    
    .hint{
      font-size:13px;
      color:#64748b;
      margin:8px 0 16px;
      padding:12px;
      background:rgba(148,163,184,.05);
      border-radius:12px;
      border-left:3px solid var(--green);
    }

    /* Enhanced chip and roadmap styles */
    .chip-group{display:flex;gap:8px;margin:12px 0 16px;flex-wrap:wrap}
    
    .chip{
      padding:10px 16px;
      border-radius:20px;
      border:1px solid #e5e7eb;
      background:linear-gradient(135deg, #fff 0%, #f8fafc 100%);
      color:#374151;
      font-size:13px;
      font-weight:500;
      cursor:pointer;
      transition:all .2s ease;
    }
    
    .chip:hover{
      transform:translateY(-1px);
      box-shadow:0 2px 8px rgba(0,0,0,.08);
    }
    
    .chip.active{
      border-color:#bbf7d0;
      background:var(--gradient-green);
      color:#fff;
      box-shadow:0 2px 12px var(--shadow-med);
    }
    
    .roadmap-list{
      display:grid;gap:12px;
      max-height:min(52vh,420px);
      overflow:auto;
      padding-right:4px;
    }
    
    .roadmap-card{
      border:1px solid #e5e7eb;
      border-radius:16px;
      padding:16px;
      background:linear-gradient(135deg, #fff 0%, #fafafa 100%);
      display:flex;justify-content:space-between;align-items:center;
      gap:16px;
      transition:all .3s ease;
      position:relative;
      overflow:hidden;
    }

    .roadmap-card:hover {
      transform:translateX(4px);
      box-shadow:0 4px 20px rgba(0,0,0,.08);
    }
    
    .rm-left{display:flex;align-items:center;gap:16px}
    
    .rm-rank{
      width:32px;height:32px;
      border-radius:12px;
      background:var(--gradient-green);
      color:#fff;
      display:grid;place-items:center;
      font-weight:800;
      font-size:14px;
      box-shadow:0 2px 8px var(--shadow-med);
    }
    
    .rm-name{font-weight:700;font-size:16px;margin-bottom:4px}
    .rm-meta{font-size:12px;color:#64748b;font-weight:500}
    .rm-stars{font-size:14px;color:#f59e0b}

    /* Enhanced camera styles */
    #activityVideo, #activitySnapshot {
      width:100%;
      border-radius:12px;
      margin:12px 0;
      box-shadow:0 4px 20px rgba(0,0,0,.15);
    }

    /* Textarea styling */
    #activityDescription {
      width:100%;
      padding:12px;
      border:1px solid #d1d5db;
      border-radius:12px;
      font-size:14px;
      min-height:80px;
      resize:vertical;
      font-family:'Sarabun',sans-serif;
    }

    #activityDescription:focus {
      outline: none;
      border-color: var(--green);
      box-shadow: 0 0 0 3px rgba(56,161,105,.1);
    }

    /* Demo button hover effects */
    .demo-btn:hover {
      transform:translateY(-1px);
      box-shadow:0 2px 8px rgba(0,0,0,.1);
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="app-title">üå± Green AR</div>
      <div class="points"><span id="coins">0</span> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
    </header>

    <main>
      <section class="tree-container">
        <div class="tree-spot">
          <div id="treeVisual" class="tree-visual" aria-label="tree-stage">
            <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏•‡πá‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏£‡∏Å -->
            <svg viewBox="0 0 200 200" style="width:200px;height:200px">
              <ellipse cx="100" cy="110" rx="22" ry="30" fill="#6b7b3f" stroke="#4a5327" stroke-width="2"/>
              <ellipse cx="98" cy="105" rx="6" ry="10" fill="#8b9556" opacity="0.6"/>
            </svg>
          </div>
        </div>

        <!-- Info card -->
        <div class="tree-info">
          <div class="info-head">
            <div class="tree-name"><span id="speciesName">‡∏ñ‡∏±‡πà‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß (Mung Bean)</span></div>
            <div class="lvl-badge">‡∏£‡∏∞‡∏î‡∏±‡∏ö <b id="treeLevel">1</b></div>
          </div>

          <div class="progress-bar"><div id="progressFill" class="progress-fill"></div></div>

          <div class="stat-row">
            <div class="progress-text" id="progressText">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤: 0% | ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å 100% ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‡πÅ‡∏ï‡∏Å‡∏´‡∏ô‡πà‡∏≠</div>
            <div class="next-label"><b>‡∏û‡∏∑‡∏ä‡∏ñ‡∏±‡∏î‡πÑ‡∏õ:</b> <span id="nextSpecies">‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤ (‡∏¢‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)</span></div>
          </div>

          <div class="info-actions">
            <button class="btn-pill" onclick="openRoadmap()">üåø ‡∏î‡∏π‡∏û‡∏∑‡∏ä‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
          </div>
        </div>
      </section>

      <!-- Environmental Activities -->
      <section class="actions">
        <h3 style="font-size:18px;font-weight:700;color:var(--green-dark);margin-bottom:16px;text-align:center">üåç ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°</h3>
        
        <!-- Main Categories -->
        <div class="category-grid">
          <div class="category-card" onclick="openActivityModal('waste')">
            <div class="category-icon">‚ôªÔ∏è</div>
            <div class="category-title">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏∞</div>
            <div class="category-desc">‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• ‡∏•‡∏î‡∏Ç‡∏¢‡∏∞ ‡∏Ñ‡∏±‡∏î‡πÅ‡∏¢‡∏Å</div>
          </div>
          
          <div class="category-card" onclick="openActivityModal('transport')">
            <div class="category-icon">üö≤</div>
            <div class="category-title">‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</div>
            <div class="category-desc">‡πÄ‡∏î‡∏¥‡∏ô ‡∏õ‡∏±‡πà‡∏ô ‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</div>
          </div>
          
          <div class="category-card" onclick="openActivityModal('energy')">
            <div class="category-icon">üí°</div>
            <div class="category-title">‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô</div>
            <div class="category-desc">‡∏õ‡∏¥‡∏î‡πÑ‡∏ü ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ô‡πâ‡∏≥</div>
          </div>
          
          <div class="category-card" onclick="openActivityModal('nature')">
            <div class="category-icon">üå±</div>
            <div class="category-title">‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥</div>
            <div class="category-desc">‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</div>
          </div>
        </div>

        <!-- Plant Care Section -->
        <div style="margin-top:24px;padding:16px;background:linear-gradient(135deg,#f0fff4,#ecfdf5);border-radius:16px;border:1px solid #bbf7d0">
          <h4 style="font-size:16px;font-weight:700;color:var(--green-dark);margin-bottom:12px;text-align:center">üåø ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h4>
          <div class="plant-care-grid">
            <button class="care-btn" onclick="careForPlant('water')" data-care="water">
              <div class="care-icon">üíß</div>
              <div>‡∏£‡∏î‡∏ô‡πâ‡∏≥</div>
              <div class="care-effect">+5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
            </button>
            
            <button class="care-btn" onclick="careForPlant('fertilizer')" data-care="fertilizer">
              <div class="care-icon">ü™¥</div>
              <div>‡πÉ‡∏™‡πà‡∏õ‡∏∏‡πã‡∏¢</div>
              <div class="care-effect">+10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
            </button>
            
            <button class="care-btn" onclick="careForPlant('sunlight')" data-care="sunlight">
              <div class="care-icon">‚òÄÔ∏è</div>
              <div>‡πÄ‡∏î‡∏¥‡∏ô‡πÅ‡∏™‡∏á</div>
              <div class="care-effect">+8 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
            </button>
          </div>
          <p style="font-size:12px;color:#059669;text-align:center;margin-top:8px">üí° ‡∏î‡∏π‡πÅ‡∏•‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÇ‡∏ï‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô</p>
        </div>

        <div style="margin-top:16px">
          <button class="ghost-btn" onclick="resetProgress()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
        </div>
      </section>
    </main>
  </div>

<!-- Bottom nav -->
<div class="bottom">
  <div>
    <button class="navbtn active" onclick="location.href='dashbroad.html'">
      <div>üè†</div>
      <small>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</small>
    </button>

    <button class="navbtn" onclick="location.href='map.html'">
      <div>üó∫Ô∏è</div>
      <small>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</small>
    </button>

    <button class="navbtn" onclick="location.href='community.html'">
      <div>üë•</div>
      <small>‡∏ä‡∏∏‡∏°‡∏ä‡∏ô</small>
    </button>

    <button class="navbtn" onclick="location.href='profile.html'">
      <div>üë§</div>
      <small>‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</small>
    </button>
  </div>